<!-- 85a8b69c-fe6e-4129-bbdb-3e25e03d3682 7facb4ed-3a34-4c99-bf11-3b0b038314c3 -->
# 優先度付きロードマップ（カテゴリ・日付拡張なし方針）

## 方針

- カテゴリは導入しない
- 締め日・支払日以外の日時（日付/日次）は導入しない（年・月粒度を継続）
- PWA対応（Web/スマホのWebアプリ）を優先

## 1. 保存基盤：PWA対応（完了）

- SharedPreferencesベースの実装に回帰
- Repositoryパターンで`application`→`infrastructure`の依存を抽象化
- Web（localStorage）とネイティブプラットフォームの両方で動作
- PWAマニフェスト設定済み

## 2. 締め日/支払日設定（完了）

- カードごとの`closingDay`/`paymentDay`設定機能
- 支払い済みアイコン表示（支払日が過ぎた場合）
- 請求月ベースの集計トグルは削除（カレンダー月ベース固定）
- 締め日基準の請求月集計ロジックは実装済み（表示切替は削除）

## 3. 可視化拡充（カテゴリ無し）

- カード比較棒グラフ（当月/選択月での各カード合計比較）
- 月次予算バー（設定した予算に対する進捗ゲージ）

## 4. 予算/通知

- カード別/全体の月次予算設定
- 予算超過時のローカル通知、支払日前のリマインド通知

## 5. セキュリティ/バックアップ

- アプリロック（PIN/生体認証）
- データ暗号化（バックアップ時）
- ローカル/クラウドバックアップ（ファイルエクスポート/インポートに限定。クラウドは利用者選択）

## 6. テスト/CI

- 予算計算ロジックのユニットテスト
- 主要画面のWidgetテスト（年選択/グラフ表示）
- CI（analyze/test/build）導入

---

### 実装対象の主なファイル

- `lib/features/cards/infrastructure/`（SharedPreferences実装、Repositories）
- `lib/features/cards/application/`（Provider、Repository利用）
- `lib/features/cards/presentation/screens/`（UI更新: 比較グラフ、予算UI）
- `lib/shared/`（フォーマッタ、通知、セキュリティ、バックアップユーティリティ）

## 補足：削除済み機能

- Drift/SQLite（PWA対応のためSharedPreferencesに回帰）
- 請求月ベース集計のトグル（カレンダー月ベース固定）

### To-dos

- [ ] カード比較棒グラフを実装（当月/選択月比較）
- [ ] 月次予算設定と進捗バー表示を実装
- [ ] 予算超過と支払日前のローカル通知を実装
- [ ] PIN/生体認証ロックとデータ暗号化を実装
- [ ] ローカル/クラウド向けバックアップ・復元ユーティリティを実装
- [ ] ユニット/Widgetテスト追加とCI導入
- [ ] 締め日基準の請求月集計ロジックを実装し表示切替に対応
- [ ] 締め日基準の請求月集計ロジックを実装し表示切替に対応